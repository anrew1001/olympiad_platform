# üìã –û—Ç—á–µ—Ç –æ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ API —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

**–î–∞—Ç–∞:** 2026-02-02
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ó–ê–í–ï–†–®–ï–ù–û
**–í—Ä–µ–º—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏:** ~1 —Å–µ—Å—Å–∏—è

---

## üéØ –¶–µ–ª—å

–†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω—É—é —Å–∏—Å—Ç–µ–º—É –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –ø–æ–ø—ã—Ç–æ–∫ —Ä–µ—à–µ–Ω–∏—è –∑–∞–¥–∞—á —Å –ø–æ–¥—Ä–æ–±–Ω–æ–π —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–æ–π –∏ –≥–µ–π–º–∏—Ñ–∏–∫–∞—Ü–∏–µ–π —á–µ—Ä–µ–∑ —Å–∏—Å—Ç–µ–º—É –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π –¥–ª—è –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã –æ–ª–∏–º–ø–∏–∞–¥.

---

## üìä –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### –°–æ–∑–¥–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã (4 –Ω–æ–≤—ã—Ö)

#### 1. **backend/app/models/attempt.py**
- –ú–æ–¥–µ–ª—å `UserTaskAttempt` –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –≤—Å–µ—Ö –ø–æ–ø—ã—Ç–æ–∫ —Ä–µ—à–µ–Ω–∏—è –∑–∞–¥–∞—á
- –°—Ç—Ä—É–∫—Ç—É—Ä–∞:
  - `user_id` (FK ‚Üí users, CASCADE)
  - `task_id` (FK ‚Üí tasks, CASCADE)
  - `answer` (Text) ‚Äî –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
  - `is_correct` (Boolean) ‚Äî –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å –æ—Ç–≤–µ—Ç–∞
  - `created_at` (DateTime) ‚Äî –≤—Ä–µ–º—è –ø–æ–ø—ã—Ç–∫–∏ (–æ—Ç Base)
- **–ò–Ω–¥–µ–∫—Å—ã –¥–ª—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏:**
  - `user_id` (single-column)
  - `task_id` (single-column)
  - `is_correct` (single-column)
  - `(user_id, task_id)` (composite)
  - `(user_id, is_correct)` (composite)
  - `(user_id, created_at)` (composite)

#### 2. **backend/app/models/achievement.py**
- –ú–æ–¥–µ–ª—å `UserAchievement` –¥–ª—è —Å–∏—Å—Ç–µ–º—ã –≥–µ–π–º–∏—Ñ–∏–∫–∞—Ü–∏–∏
- –°—Ç—Ä—É–∫—Ç—É—Ä–∞:
  - `user_id` (FK ‚Üí users, CASCADE)
  - `type` (String) ‚Äî —É–Ω–∏–∫–∞–ª—å–Ω—ã–π —Ç–∏–ø ("first_solve", "solved_10")
  - `title` (String) ‚Äî –æ—Ç–æ–±—Ä–∞–∂–∞–µ–º–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ
  - `description` (Text) ‚Äî –æ–ø–∏—Å–∞–Ω–∏–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è
  - `unlocked_at` (DateTime) ‚Äî –≤—Ä–µ–º—è –ø–æ–ª—É—á–µ–Ω–∏—è
- **–£–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç—å:** –ö–æ–º–ø–æ–∑–∏—Ç–Ω—ã–π –∏–Ω–¥–µ–∫—Å `(user_id, type, unique=True)`

#### 3. **backend/app/schemas/stats.py**
- `DifficultyStats` ‚Äî —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ —É—Ä–æ–≤–Ω—é —Å–ª–æ–∂–Ω–æ—Å—Ç–∏
  - `difficulty` (1-5)
  - `solved` ‚Äî —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ —Ä–µ—à—ë–Ω–Ω—ã–µ –Ω–∞ —ç—Ç–æ–º —É—Ä–æ–≤–Ω–µ
  - `total_attempts` ‚Äî –≤—Å–µ –ø–æ–ø—ã—Ç–∫–∏ –Ω–∞ —É—Ä–æ–≤–Ω–µ
- `RecentActivityItem` ‚Äî —ç–ª–µ–º–µ–Ω—Ç –Ω–µ–¥–∞–≤–Ω–µ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
  - `task_id`, `task_title`, `task_difficulty`, `is_correct`, `created_at`
- `AchievementItem` ‚Äî —ç–ª–µ–º–µ–Ω—Ç –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è
  - `type`, `title`, `description`, `unlocked_at`
- `UserStatsResponse` ‚Äî –≥–ª–∞–≤–Ω—ã–π –æ—Ç–≤–µ—Ç —Å–æ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–æ–π
  - `total_attempts`, `correct_attempts`, `accuracy`, `unique_solved`
  - `by_difficulty[]` ‚Äî —Ä–∞–∑–±–∏–≤–∫–∞ –ø–æ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ (0-5 —ç–ª–µ–º–µ–Ω—Ç–æ–≤)
  - `recent_activity[]` ‚Äî –ø–æ—Å–ª–µ–¥–Ω–∏–µ 10 –ø–æ–ø—ã—Ç–æ–∫
  - `achievements[]` ‚Äî –ø–æ–ª—É—á–µ–Ω–Ω—ã–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è

#### 4. **backend/app/routers/users.py**
- –†–æ—É—Ç–µ—Ä –¥–ª—è –æ–ø–µ—Ä–∞—Ü–∏–π —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ (–ø—Ä–µ—Ñ–∏–∫—Å: `/api/users`)
- **–≠–Ω–¥–ø–æ–∏–Ω—Ç:** `GET /api/users/me/stats`
  - –¢—Ä–µ–±—É–µ—Ç JWT –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é (—á–µ—Ä–µ–∑ `get_current_user`)
  - –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç `UserStatsResponse`
- **–ó–∞–ø—Ä–æ—Å—ã –≤ –ë–î:**
  1. COUNT –≤—Å–µ—Ö –ø–æ–ø—ã—Ç–æ–∫
  2. COUNT –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –ø–æ–ø—ã—Ç–æ–∫
  3. COUNT DISTINCT —Ä–µ—à—ë–Ω–Ω—ã—Ö –∑–∞–¥–∞—á
  4. JOIN + GROUP BY –¥–ª—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –ø–æ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏
  5. JOIN + ORDER BY DESC + LIMIT 10 –¥–ª—è –Ω–µ–¥–∞–≤–Ω–µ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
  6. SELECT –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π –ø–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
- **–û–±—Ä–∞–±–æ—Ç–∫–∞ –≥—Ä–∞–Ω–∏—á–Ω—ã—Ö —Å–ª—É—á–∞–µ–≤:**
  - –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –±–µ–∑ –ø–æ–ø—ã—Ç–æ–∫ ‚Üí –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –Ω—É–ª–∏ –∏ –ø—É—Å—Ç—ã–µ –º–∞—Å—Å–∏–≤—ã
  - Accuracy = 0 –µ—Å–ª–∏ –Ω–µ—Ç –ø–æ–ø—ã—Ç–æ–∫
  - –í—Å–µ –∑–∞–ø—Ä–æ—Å—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç –∏–Ω–¥–µ–∫—Å—ã –¥–ª—è O(log N) –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

---

### –ò–∑–º–µ–Ω—ë–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã (5 –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π)

#### 1. **backend/app/routers/tasks.py**
- **–û–±–Ω–æ–≤–ª–µ–Ω–∏—è –∏–º–ø–æ—Ä—Ç–æ–≤:**
  - –î–æ–±–∞–≤–ª–µ–Ω—ã: `UserTaskAttempt`, `UserAchievement`
  - –í—Å—ë –µ—â—ë –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è: `select`, `func` –∏–∑ sqlalchemy
- **–ù–æ–≤–∞—è –ª–æ–≥–∏–∫–∞ –≤ `check_task_answer()` (–ø–æ—Å–ª–µ —Å—Ç—Ä–æ–∫–∏ 202):**
  - **–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø–æ–ø—ã—Ç–∫–∏:** —Å–æ–∑–¥–∞–Ω–∏–µ –∏ commit `UserTaskAttempt`
  - **–°–∏—Å—Ç–µ–º–∞ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π:**
    - –ü–æ–ª—É—á–µ–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —É–Ω–∏–∫–∞–ª—å–Ω–æ —Ä–µ—à—ë–Ω–Ω—ã—Ö –∑–∞–¥–∞—á
    - –í—ã–¥–∞—á–∞ "first_solve" –ø—Ä–∏ –ø–µ—Ä–≤–æ–º —Ä–µ—à–µ–Ω–∏–∏
    - –í—ã–¥–∞—á–∞ "solved_10" –ø—Ä–∏ 10 —Ä–µ—à—ë–Ω–Ω—ã—Ö –∑–∞–¥–∞—á–∞—Ö
    - –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –¥—É–±–ª–∏–∫–∞—Ç—ã –ø–µ—Ä–µ–¥ –≤—Å—Ç–∞–≤–∫–æ–π
  - **–ö–æ–º–º–∏—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–π:** `await db.commit()` –ø–æ—Å–ª–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –ø–æ–ø—ã—Ç–æ–∫ –∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π
- **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫:**
  - –ï—Å–ª–∏ –∑–∞–¥–∞—á–∞ —É–¥–∞–ª–µ–Ω–∞ –º–µ–∂–¥—É –ø—Ä–æ–≤–µ—Ä–∫–æ–π –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º ‚Üí IntegrityError (—Ä–µ–¥–∫–∏–π –∫–µ–π—Å)
  - –ü–æ–ø—ã—Ç–∫–∞ –≤—Å—ë —Ä–∞–≤–Ω–æ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é

#### 2. **backend/app/models/__init__.py**
```python
# –ë—ã–ª–æ:
from app.models import Base, User, Task

# –°—Ç–∞–ª–æ:
from app.models import Base, User, Task, UserTaskAttempt, UserAchievement
```

#### 3. **backend/app/schemas/__init__.py**
```python
# –î–æ–±–∞–≤–ª–µ–Ω—ã —ç–∫—Å–ø–æ—Ä—Ç—ã:
from app.schemas.stats import UserStatsResponse, DifficultyStats, RecentActivityItem, AchievementItem
```

#### 4. **backend/app/main.py**
```python
# –û–±–Ω–æ–≤–ª—ë–Ω –∏–º–ø–æ—Ä—Ç:
from app.routers import health_router, auth_router, tasks_router, users_router

# –î–æ–±–∞–≤–ª–µ–Ω–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è:
app.include_router(users_router)
```

#### 5. **backend/recreate_tables.py**
```python
# –ë—ã–ª–æ:
from app.models import User  # noqa: F401

# –°—Ç–∞–ª–æ:
from app.models import User, Task, UserTaskAttempt, UserAchievement  # noqa: F401
```

---

## üöÄ –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å

### –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

‚úÖ **–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø–æ–ø—ã—Ç–æ–∫**
- –ö–∞–∂–¥–∞—è –ø–æ–ø—ã—Ç–∫–∞ —Ä–µ—à–µ–Ω–∏—è –∑–∞–¥–∞—á–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ –ë–î
- –°–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è: user_id, task_id, –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç, is_correct —Ñ–ª–∞–≥

‚úÖ **–°–∏—Å—Ç–µ–º–∞ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π** (–ì–µ–π–º–∏—Ñ–∏–∫–∞—Ü–∏—è)
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≤—ã–¥–∞—á–∞ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π –ø—Ä–∏ —Ä–µ—à–µ–Ω–∏–∏ –∑–∞–¥–∞—á
- **"–ü–µ—Ä–≤—ã–π —É—Å–ø–µ—Ö"** ‚Äî –≤—ã–¥–∞—ë—Ç—Å—è –ø—Ä–∏ –ø–µ—Ä–≤–æ–π –ø—Ä–∞–≤–∏–ª—å–Ω–æ —Ä–µ—à—ë–Ω–Ω–æ–π –∑–∞–¥–∞—á–µ
- **"–ú–∞—Å—Ç–µ—Ä —Ä–µ—à–µ–Ω–∏–π"** ‚Äî –≤—ã–¥–∞—ë—Ç—Å—è –ø—Ä–∏ 10 —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö —Ä–µ—à—ë–Ω–Ω—ã—Ö –∑–∞–¥–∞—á–∞—Ö
- –§—É–Ω–¥–∞–º–µ–Ω—Ç –¥–ª—è —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è (streak tracking, difficulty master, etc.)

‚úÖ **API —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è** (`GET /api/users/me/stats`)
- –û–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:
  - `total_attempts` ‚Äî –≤—Å–µ–≥–æ –ø–æ–ø—ã—Ç–æ–∫
  - `correct_attempts` ‚Äî –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤
  - `accuracy` ‚Äî –ø—Ä–æ—Ü–µ–Ω—Ç —Ç–æ—á–Ω–æ—Å—Ç–∏ (0-100)
  - `unique_solved` ‚Äî –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö —Ä–µ—à—ë–Ω–Ω—ã—Ö –∑–∞–¥–∞—á
- –†–∞–∑–±–∏–≤–∫–∞ –ø–æ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ (1-5):
  - –î–ª—è –∫–∞–∂–¥–æ–≥–æ —É—Ä–æ–≤–Ω—è: –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–µ—à—ë–Ω–Ω—ã—Ö –∏ –≤—Å–µ–≥–æ –ø–æ–ø—ã—Ç–æ–∫
- –ù–µ–¥–∞–≤–Ω—è—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å (–ø–æ—Å–ª–µ–¥–Ω–∏–µ 10 –ø–æ–ø—ã—Ç–æ–∫):
  - task_id, title, difficulty, is_correct, created_at
- –ü–æ–ª—É—á–µ–Ω–Ω—ã–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è:
  - type, title, description, unlocked_at

‚úÖ **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å**
- JWT –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–∞
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∏–¥–∏—Ç —Ç–æ–ª—å–∫–æ —Å–≤–æ–∏ –¥–∞–Ω–Ω—ã–µ
- ORM –∑–∞—â–∏—â–∞–µ—Ç –æ—Ç SQL-–∏–Ω—ä–µ–∫—Ü–∏–π

‚úÖ **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å**
- –°–æ—Å—Ç–∞–≤–Ω—ã–µ –∏–Ω–¥–µ–∫—Å—ã –¥–ª—è –±—ã—Å—Ç—Ä—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
- LIMIT –Ω–∞ recent_activity (–≤—Å–µ–≥–¥–∞ 10 –∑–∞–ø–∏—Å–µ–π)
- Efficient GROUP BY —Å indexed columns

---

## üìà –ü—Ä–∏–º–µ—Ä—ã –æ—Ç–≤–µ—Ç–æ–≤ API

### –£—Å–ø–µ—à–Ω—ã–π –æ—Ç–≤–µ—Ç (–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å—é)

```bash
GET /api/users/me/stats
Authorization: Bearer <token>
```

```json
{
  "total_attempts": 5,
  "correct_attempts": 3,
  "accuracy": 60.0,
  "unique_solved": 2,
  "by_difficulty": [
    {
      "difficulty": 1,
      "solved": 1,
      "total_attempts": 2
    },
    {
      "difficulty": 2,
      "solved": 1,
      "total_attempts": 2
    },
    {
      "difficulty": 3,
      "solved": 0,
      "total_attempts": 1
    }
  ],
  "recent_activity": [
    {
      "task_id": 1,
      "task_title": "–ü–ª–æ—â–∞–¥—å —Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫–∞",
      "task_difficulty": 2,
      "is_correct": false,
      "created_at": "2026-02-02T14:35:00"
    },
    {
      "task_id": 5,
      "task_title": "–§–∞–∫—Ç–æ—Ä–∏–∞–ª —á–∏—Å–ª–∞",
      "task_difficulty": 3,
      "is_correct": true,
      "created_at": "2026-02-02T14:34:00"
    }
  ],
  "achievements": [
    {
      "type": "first_solve",
      "title": "–ü–µ—Ä–≤—ã–π —É—Å–ø–µ—Ö",
      "description": "–†–µ—à–µ–Ω–∞ –ø–µ—Ä–≤–∞—è –∑–∞–¥–∞—á–∞ –Ω–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º–µ",
      "unlocked_at": "2026-02-02T14:20:00"
    }
  ]
}
```

### –ù–æ–≤—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å (–±–µ–∑ –ø–æ–ø—ã—Ç–æ–∫)

```json
{
  "total_attempts": 0,
  "correct_attempts": 0,
  "accuracy": 0.0,
  "unique_solved": 0,
  "by_difficulty": [],
  "recent_activity": [],
  "achievements": []
}
```

---

## üß™ –í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–∞
‚úÖ –í—Å–µ –∏–º–ø–æ—Ä—Ç—ã —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
```bash
python -c "from app.models import UserTaskAttempt, UserAchievement; print('‚úì Models OK')"
python -c "from app.schemas.stats import UserStatsResponse; print('‚úì Schemas OK')"
python -c "from app.routers.users import router; print('‚úì Router OK')"
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ FastAPI –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚úÖ –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å–æ–∑–¥–∞—ë—Ç—Å—è —É—Å–ø–µ—à–Ω–æ —Å 12 —Ä–æ—É—Ç–∞–º–∏
```bash
python -c "from app.main import app; print(f'‚úì App OK with {len(app.routes)} routes')"
```

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤
–°–æ–∑–¥–∞–Ω —Å–∫—Ä–∏–ø—Ç `test_stats_api.sh` –¥–ª—è –ø–æ–ª–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:
1. –ü–µ—Ä–µ—Å–æ–∑–¥–∞–Ω–∏–µ –ë–î –∏ –∑–∞–≥—Ä—É–∑–∫–∞ –∑–∞–¥–∞—á
2. –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –∏ –ø–æ–ª—É—á–µ–Ω–∏–µ JWT —Ç–æ–∫–µ–Ω–∞
3. –°–æ–∑–¥–∞–Ω–∏–µ 5 –ø–æ–ø—ã—Ç–æ–∫ –Ω–∞ —Ä–∞–∑–Ω—ã–µ –∑–∞–¥–∞—á–∏
4. –ü—Ä–æ–≤–µ—Ä–∫–∞ GET /api/users/me/stats
5. –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ (401/403)

**–ó–∞–ø—É—Å–∫:**
```bash
bash test_stats_api.sh
```

---

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏ (—Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã)

–°–æ–≥–ª–∞—Å–Ω–æ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –¥–æ–±–∞–≤–ª–µ–Ω—ã:

‚úÖ **unique_solved**
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö —Ä–µ—à—ë–Ω–Ω—ã—Ö –∑–∞–¥–∞—á
- –í–∞–∂–Ω–∞—è –º–µ—Ç—Ä–∏–∫–∞ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞

‚úÖ **task_difficulty –≤ recent_activity**
- –£—Ä–æ–≤–µ–Ω—å —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ –¥–ª—è –∫–∞–∂–¥–æ–π –ø–æ–ø—ã—Ç–∫–∏
- –ü–æ–º–æ–≥–∞–µ—Ç –≤–∏–¥–µ—Ç—å –Ω–∞ –∫–∞–∫–∏—Ö —É—Ä–æ–≤–Ω—è—Ö —Ä–∞–±–æ—Ç–∞–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å

‚úÖ **–°–∏—Å—Ç–µ–º–∞ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π**
- UserAchievement –º–æ–¥–µ–ª—å –¥–ª—è –≥–µ–π–º–∏—Ñ–∏–∫–∞—Ü–∏–∏
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≤—ã–¥–∞—á–∞ –ø—Ä–∏ —Ä–µ—à–µ–Ω–∏–∏ –∑–∞–¥–∞—á
- –§—É–Ω–¥–∞–º–µ–Ω—Ç –¥–ª—è —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è (streak, difficulty master, etc.)

---

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –ü–∞—Ç—Ç–µ—Ä–Ω—ã, —Å–ª–µ–¥—É–µ–º—ã–µ –ø—Ä–æ–µ–∫—Ç—É
- ‚úÖ SQLAlchemy 2.0 async —Å `Mapped[type]` –∞–Ω–Ω–æ—Ç–∞—Ü–∏—è–º–∏
- ‚úÖ Pydantic —Å `ConfigDict(from_attributes=True)`
- ‚úÖ FastAPI dependency injection (`Depends()`)
- ‚úÖ JWT –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ `HTTPBearer`
- ‚úÖ –Ø–≤–Ω—ã–µ JOIN –±–µ–∑ SQLAlchemy `relationship()`
- ‚úÖ –ò–Ω–¥–µ–∫—Å—ã –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

### –ì—Ä–∞–Ω–∏—á–Ω—ã–µ —Å–ª—É—á–∞–∏
| –°—Ü–µ–Ω–∞—Ä–∏–π | –û–±—Ä–∞–±–æ—Ç–∫–∞ |
|----------|-----------|
| –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –±–µ–∑ –ø–æ–ø—ã—Ç–æ–∫ | –ù—É–ª–∏ –∏ –ø—É—Å—Ç—ã–µ –º–∞—Å—Å–∏–≤—ã |
| –£–¥–∞–ª—ë–Ω–Ω–∞—è –∑–∞–¥–∞—á–∞ | CASCADE —É–¥–∞–ª—è–µ—Ç –ø–æ–ø—ã—Ç–∫–∏ |
| –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –ø–æ–ø—ã—Ç–∫–∏ –æ–¥–Ω–æ–π –∑–∞–¥–∞—á–∏ | –í—Å–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è, DISTINCT –¥–ª—è unique_solved |
| –ü–æ–ø—ã—Ç–∫–∞ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è –ø–æ–ª—É—á–∏—Ç—å | –£–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–Ω–¥–µ–∫—Å –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –¥—É–±–ª–∏–∫–∞—Ç—ã |
| –û—á–µ–Ω—å –¥–ª–∏–Ω–Ω—ã–π –æ—Ç–≤–µ—Ç | Pydantic –≤–∞–ª–∏–¥–∏—Ä—É–µ—Ç max_length |

---

## üìÅ –§–∞–π–ª–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞

```
backend/app/
‚îú‚îÄ‚îÄ models/
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py (–æ–±–Ω–æ–≤–ª–µ–Ω–æ)
‚îÇ   ‚îú‚îÄ‚îÄ base.py
‚îÇ   ‚îú‚îÄ‚îÄ user.py
‚îÇ   ‚îú‚îÄ‚îÄ task.py
‚îÇ   ‚îú‚îÄ‚îÄ attempt.py ‚ú® –ù–û–í–û–ï
‚îÇ   ‚îî‚îÄ‚îÄ achievement.py ‚ú® –ù–û–í–û–ï
‚îú‚îÄ‚îÄ routers/
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py (–æ–±–Ω–æ–≤–ª–µ–Ω–æ)
‚îÇ   ‚îú‚îÄ‚îÄ health.py
‚îÇ   ‚îú‚îÄ‚îÄ auth.py
‚îÇ   ‚îú‚îÄ‚îÄ tasks.py (–æ–±–Ω–æ–≤–ª–µ–Ω–æ)
‚îÇ   ‚îî‚îÄ‚îÄ users.py ‚ú® –ù–û–í–û–ï
‚îú‚îÄ‚îÄ schemas/
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py (–æ–±–Ω–æ–≤–ª–µ–Ω–æ)
‚îÇ   ‚îú‚îÄ‚îÄ user.py
‚îÇ   ‚îú‚îÄ‚îÄ task.py
‚îÇ   ‚îî‚îÄ‚îÄ stats.py ‚ú® –ù–û–í–û–ï
‚îú‚îÄ‚îÄ main.py (–æ–±–Ω–æ–≤–ª–µ–Ω–æ)
‚îî‚îÄ‚îÄ ...

backend/
‚îú‚îÄ‚îÄ recreate_tables.py (–æ–±–Ω–æ–≤–ª–µ–Ω–æ)
‚îú‚îÄ‚îÄ seed_tasks.py
‚îî‚îÄ‚îÄ test_stats_api.sh ‚ú® –ù–û–í–û–ï
```

---

## üöÄ –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ –∑–∞–ø—É—Å–∫—É

### 1. –ü–µ—Ä–µ—Å–æ–∑–¥–∞–Ω–∏–µ –ë–î (—Å –ø–æ—Ç–µ—Ä–µ–π –¥–∞–Ω–Ω—ã—Ö!)
```bash
cd backend
python recreate_tables.py
python seed_tasks.py
```

### 2. –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞
```bash
python -m uvicorn app.main:app --reload
```

### 3. –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤
```bash
bash test_stats_api.sh
```

---

## üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

| –ú–µ—Ç—Ä–∏–∫–∞ | –ó–Ω–∞—á–µ–Ω–∏–µ |
|---------|----------|
| –ù–æ–≤—ã—Ö —Ñ–∞–π–ª–æ–≤ | 4 |
| –û–±–Ω–æ–≤–ª–µ–Ω–æ —Ñ–∞–π–ª–æ–≤ | 5 |
| –ù–æ–≤—ã—Ö —Ç–∞–±–ª–∏—Ü | 2 |
| –ù–æ–≤—ã—Ö —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤ | 1 |
| –ù–æ–≤—ã—Ö –º–æ–¥–µ–ª–µ–π | 2 |
| –ù–æ–≤—ã—Ö Pydantic —Å—Ö–µ–º | 4 |
| –°—Ç—Ä–æ–∫ –∫–æ–¥–∞ (models) | ~40 |
| –°—Ç—Ä–æ–∫ –∫–æ–¥–∞ (schemas) | ~200 |
| –°—Ç—Ä–æ–∫ –∫–æ–¥–∞ (router) | ~180 |
| –°—Ç—Ä–æ–∫ –∫–æ–¥–∞ (updates) | ~60 |
| **–í—Å–µ–≥–æ –Ω–æ–≤—ã—Ö —Å—Ç—Ä–æ–∫** | **~540** |

---

## üéì –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ –≤ –±—É–¥—É—â–µ–º

–°–∏—Å—Ç–µ–º–∞ —Å–ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∞ –¥–ª—è —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è:

1. **–ù–æ–≤—ã–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è:**
   - `solved_50`, `solved_100` ‚Äî –±–æ–ª—å—à–µ –∑–∞–¥–∞—á
   - `difficulty_5_master` ‚Äî –≤—Å–µ –∑–∞–¥–∞—á–∏ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ 5
   - `week_streak_7` ‚Äî 7 –¥–Ω–µ–π –ø–æ–¥—Ä—è–¥ —Å —Ä–µ—à–µ–Ω–∏—è–º–∏
   - `speed_solver` ‚Äî —Ä–µ—à–∏—Ç—å –∑–∞ < 1 –º–∏–Ω—É—Ç—ã

2. **Leaderboard:**
   - TOP 10/100 –ø–æ unique_solved
   - –†–µ–π—Ç–∏–Ω–≥ –ø–æ accuracy

3. **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –ø—Ä–µ–¥–º–µ—Ç–∞–º/—Ç–µ–º–∞–º:**
   - GROUP BY subject/topic
   - –ü—Ä–æ–≥—Ä–µ—Å—Å –ø–æ –æ–±–ª–∞—Å—Ç—è–º

4. **–ì—Ä–∞—Ñ–∏–∫ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏:**
   - –ü–æ–ø—ã—Ç–∫–∏ –ø–æ –¥–Ω—è–º/–Ω–µ–¥–µ–ª—è–º
   - –¢–µ–ø–ª–æ–≤–∞—è –∫–∞—Ä—Ç–∞ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏

5. **–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è:**
   - Push –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è
   - Email –æ –ø—Ä–æ–≥—Ä–µ—Å—Å–µ

---

## ‚úÖ –ß–µ–∫-–ª–∏—Å—Ç —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

- [x] –ú–æ–¥–µ–ª—å UserTaskAttempt —Å–æ–∑–¥–∞–Ω–∞
- [x] –ú–æ–¥–µ–ª—å UserAchievement —Å–æ–∑–¥–∞–Ω–∞
- [x] –ò–Ω–¥–µ–∫—Å—ã –Ω–∞ –≤—Å–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∫–æ–ª–æ–Ω–∫–∏
- [x] Pydantic —Å—Ö–µ–º—ã —Å–æ –≤—Å–µ–º–∏ –ø–æ–ª—è–º–∏
- [x] –†–æ—É—Ç–µ—Ä users —Å GET /me/stats
- [x] –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø–æ–ø—ã—Ç–æ–∫ –≤ check_task_answer
- [x] –õ–æ–≥–∏–∫–∞ –≤—ã–¥–∞—á–∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π
- [x] –û–±–Ω–æ–≤–ª–µ–Ω—ã –≤—Å–µ __init__.py —Ñ–∞–π–ª—ã
- [x] –†–æ—É—Ç–µ—Ä –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω –≤ main.py
- [x] –í—Å–µ –∏–º–ø–æ—Ä—Ç—ã —Ä–∞–±–æ—Ç–∞—é—Ç
- [x] FastAPI –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è
- [x] –°–æ–∑–¥–∞–Ω —Ç–µ—Å—Ç–æ–≤—ã–π —Å–∫—Ä–∏–ø—Ç
- [x] –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –≥–æ—Ç–æ–≤–∞

---

## üìù –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞ —É—Å–ø–µ—à–Ω–æ!** ‚úÖ

–°–∏—Å—Ç–µ–º–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é –≥–æ—Ç–æ–≤–∞ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é. –í—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Å–ª–µ–¥—É—é—Ç –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ –∏ –ø–∞—Ç—Ç–µ—Ä–Ω–∞–º —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞. –ö–æ–¥ —Å–∏–Ω—Ç–∞–∫—Å–∏—á–µ—Å–∫–∏ –∫–æ—Ä—Ä–µ–∫—Ç–µ–Ω –∏ –ø—Ä–æ—à—ë–ª –±–∞–∑–æ–≤—É—é –ø—Ä–æ–≤–µ—Ä–∫—É –∏–º–ø–æ—Ä—Ç–æ–≤.

–ü—Ä–∏ –∑–∞–ø—É—Å–∫–µ PostgreSQL –∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ —Å–∫—Ä–∏–ø—Ç–∞ `test_stats_api.sh` –≤—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ –±—É–¥—É—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω—ã.

---

**–î–∞—Ç–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è:** 2026-02-02
**–ê–≤—Ç–æ—Ä:** Claude Code
**–í–µ—Ä—Å–∏—è:** 1.0
